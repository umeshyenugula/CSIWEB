  <!doctype html>
  <html lang="en">

  <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width,initial-scale=1" />
      <title>Computer Society of India — GRIET</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
      <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;600;700;900&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="/static/css/style.css" />
      <!-- <link rel="stylesheet" href="/static/css/styleadmin.css" /> -->
  </head>

  <body>

      <div id="overlay" class="overlay" aria-hidden="true"></div>
      <aside id="sidebar" class="sidebar" aria-hidden="true" aria-label="Mobile navigation" role="dialog"
          aria-modal="true">
          <div style="display:flex;align-items:center;justify-content:space-between;">
              <div style="display:flex;align-items:center;gap:12px">
                  <div>
                      <div style="font-weight:800;color:var(--bark)">Menu</div>
                      
                  </div>
              </div>
              <button id="sidebarClose" class="close-btn" aria-label="Close menu">Close</button>
          </div>

          <nav class="nav-bar">
      <a class="nav-link" data-page="main" href="/">Home</a>
      <a class="nav-link" data-page="aboutus" href="/aboutus">About Us</a>
      <a class="nav-link" data-page="ourteam" href="/ourteam">Our Team</a>
      <a class="nav-link" data-page="events" href="/events">Events</a>
      <a class="nav-link" data-page="resonance" href="/resonance">Resonance</a>
      <a class="nav-link" data-page="certificates" href="/certificates">Certificates</a>
      <a class="nav-link" data-page="alumni" href="/alumni">Alumni</a>
      <a class="nav-link" data-page="admin-login" href="/admin">Admin Login</a>
  </nav>

      </aside>

      <!-- header -->
      <header class="site-header" role="banner">
          <div class="header-inner">
              <div class="header-left">
                  <button id="hamburger" class="hamburger" aria-expanded="false" aria-controls="sidebar"
                      aria-label="Open menu" >
                      <span class="bar"></span>
                  </button>

                  <div class="logo-box" aria-hidden="false">
                      <img id="leftLogo" src="https://www.srit.ac.in/wp-content/uploads/2022/01/csi-logo.png" alt="Left logo">

                  </div>
              </div>

              <div class="header-center" role="heading" aria-level="1">
                  <h1 class="site-title">Computer Society of India</h1>
                  <span class="site-sub">Gokaraju Rangaraju Institute of Engineering &amp; Technology</span>
              </div>

              <div class="header-right">
                  <div class="logo-box" aria-hidden="false">
                      <img id="rightLogo" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSqTkkG-9c2jad8zMOjRkn8o8qZ-L9nnRC5JA&s" alt="Right logo">
                  </div>
              </div>
          </div>

          <div class="nav-row">
              <nav class="nav-bar">
      <a class="nav-link" data-page="main" href="/">Home</a>
      <a class="nav-link" data-page="aboutus" href="/aboutus">About Us</a>
      <a class="nav-link" data-page="ourteam" href="/ourteam">Our Team</a>
      <a class="nav-link" data-page="events" href="/events">Events</a>
      <a class="nav-link" data-page="resonance" href="/resonance">Resonance</a>
      <a class="nav-link" data-page="certificates" href="/certificates">Certificates</a>
      <a class="nav-link" data-page="alumni" href="/alumni">Alumni</a>
      <a class="nav-link" data-page="admin-login" href="/admin">Admin Login</a>
  </nav>

          </div>
      </header>
      <main id="main-content">

      </main>

    <footer id="footer">
    <div class="footer-container">
      <div class="footer-left fade-in">
        <img src="https://www.srit.ac.in/wp-content/uploads/2022/01/csi-logo.png" alt="CSI Logo" class="footer-logo">
        <h3>Address</h3>
        <p>
          Gokaraju Rangaraju Institute of Engineering and Technology,<br>
          Bachupally, Nizampet, Hyderabad,<br>
          Telangana, India - 500090
        </p>
        <a href="#" class="footer-btn">Get Directions</a>

        <div class="footer-contact">
          <h4>Hasmitha</h4>
          <p>Convener</p>
          <p>Ph. No.: 1234567890</p>
          <p>E-mail: <a href="mailto:csigrietcom@gmail.com">csigrietcom@gmail.com</a></p>
        </div>

        <div class="socials">
          <a href="#"><i class="fa-brands fa-instagram"></i></a>
          <a href="#"><i class="fa-brands fa-linkedin"></i></a>
        </div>
      </div>

      <div class="footer-middle fade-in">
        <h3>Events</h3>
        <ul class="footer-links two-column">
          <li><a href="#">SequenceSaga</a></li>
          <li><a href="#">Resonance'25</a></li>
          <li><a href="#">Code and Ladders</a></li>
          <li><a href="#">IdeaQuest</a></li>
          <li><a href="#">Resonance'24</a></li>
          <li><a href="#">Generative AI Seminar</a></li>
          <li><a href="#">Blockchain Seminar</a></li>
          <li><a href="#">Resonance'23</a></li>
          <li><a href="#">Cyber Congress Workshop</a></li>
          <li><a href="#">Codigo 2.0</a></li>
          <li><a href="#">Digital Parenting Workshop</a></li>
          <li><a href="#">Cyber Security and Ethical Hacking</a></li>
        </ul>

        <h3>Event Reports</h3>
        <ul class="footer-links">
          <li><a href="#">IdeaQuest</a></li>
          <li><a href="#">2022 - 23</a></li>
          <li><a href="#">Resonance'24</a></li>
          <li><a href="#">2023 - 24</a></li>
          <li><a href="#">Annual Report</a></li>
        </ul>
      </div>
      <div class="footer-right fade-in">
        <div class="footer-buttons">
          <a href="/griet" class="footer-btn">Visit GRIET</a>
          <a href="/enquire" class="footer-btn">Enquire</a>
          <a href="/apply-membership" class="footer-btn">Apply Membership</a>
        </div>
      </div>

    </div>

    <div class="footer-bottom">
    © <span id="year"></span> CSI GRIET — All Rights Reserved.
  </div>

  </footer>
  <script>
  document.addEventListener("DOMContentLoaded", () => {
      const main = document.querySelector("#main-content");
      const links = document.querySelectorAll(".nav-link, .sidebar nav a");

      // Admin login handling
      function bindAdminLogin() {
          const form = document.querySelector(".admin-login-form");
          if (!form) {
              console.warn("Admin login form not found.");
              return;
          }

          form.addEventListener("submit", async (e) => {
              e.preventDefault();

              const username = document.getElementById("adminUser").value.trim();
              const password = document.getElementById("adminPass").value.trim();

              if (!username || !password) {
                  alert("Please fill all fields");
                  return;
              }

              try {
                  console.log("Sending fetch to /admin/login...");

                  const res = await fetch("/admin/login", {
                      method: "POST",
                      headers: { "Content-Type": "application/json" },
                      body: JSON.stringify({ username, password })
                  });

                  const data = await res.json();
                  console.log("Response:", data);

                  if (data.status === "success") {
                      window.location.href = data.redirect;
                  } else {
                      alert(data.message);
                  }
              } catch (err) {
                  console.error("Fetch error:", err);
              }
          });
      }

      async function loadSection(page, clickedLink = null, pushUrl = true) {
          try {
              if (page === "home") page = "main";

              const res = await fetch(`/partials/${page}`);
              if (!res.ok) throw new Error("Page not found");

              const html = await res.text();
              main.innerHTML = html;

              if (page === "admin-login") bindAdminLogin();
                if (page === "main" || page==="main#") {
                 updateHeroSection();  
}
if (page === "events") {
    loadEventsPage().then(() => {
    });
}


              if (page === "main" && typeof initPreviousYearAnimations === "function") {
                  initPreviousYearAnimations();
                   updateHeroSection();  
              }

              if (typeof gsap !== "undefined") {
                  gsap.from(main, { opacity: 0, y: 20, duration: 0.5 });
              }

              links.forEach(l => l.classList.remove("active"));
              if (clickedLink) clickedLink.classList.add("active");

              if (pushUrl) {
                  const sessionKey = sessionStorage.getItem("sessionKey") || "guest";
                  history.pushState(
                      { page },
                      "",
                      `/pages/${page}`
                  );
              }

          } catch (err) {
              main.innerHTML = `
              <section style="padding:60px;text-align:center;">
                  <h2>⚠️ Page not found</h2>
                  <p>The section you're trying to open doesn't exist yet.</p>
              </section>`;
          }
      }

      // Handle page refresh
      window.addEventListener("popstate", (e) => {
          const page =
              e.state?.page ||
              window.location.pathname.replace("/pages/", "") ||
              "main";

          loadSection(page, null, false);
      });

      // Load initial section
      loadSection("main");

      links.forEach(link => {
          link.addEventListener("click", e => {
              e.preventDefault();
              const page = e.target.textContent.trim().toLowerCase().replace(/['& ]+/g, "-");
              loadSection(page, e.target, true);
              if (typeof closeSidebar === "function") closeSidebar();
          });
      });

      // Initialize gallery animations
      function initGalleryAnimations() {
          const items = document.querySelectorAll(".grid-item");
          items.forEach(item => {
              item.addEventListener("mouseenter", () => {
                  item.classList.add("hovered");
              });
              item.addEventListener("mouseleave", () => {
                  item.classList.remove("hovered");
              });
          });
      }

      // Initialize previous year animations
      function initPreviousYearAnimations() {
          const items = document.querySelectorAll(".grid-item");
          items.forEach(item => {
              item.addEventListener("mouseenter", () => item.classList.add("hovered"));
              item.addEventListener("mouseleave", () => item.classList.remove("hovered"));
          });

          if (typeof gsap !== "undefined") {
              gsap.from(".grid-item", {
                  opacity: 0,
                  y: 30,
                  duration: 0.6,
                  stagger: 0.1,
                  ease: "power2.out"
              });
          }
      }

      gsap.from("footer > *", {
          opacity: 0,
          y: 30,
          duration: 0.8,
          stagger: 0.2,
          scrollTrigger: {
              trigger: "footer",
              start: "top 90%",
          }
      });

      gsap.utils.toArray('.vam-card').forEach((card, i) => {
          gsap.from(card, {
              scrollTrigger: {
                  trigger: card,
                  start: "top 85%",
                  toggleActions: "play none none reverse"
              },
              y: 40,
              opacity: 0,
              duration: 0.9,
              delay: i * 0.1,
              ease: "power3.out"
          });
      });

      document.getElementById('year').textContent = new Date().getFullYear();

      // Sidebar + hero effects (unchanged)
      const overlay = document.getElementById('overlay');
      const sidebar = document.getElementById('sidebar');
      const hamburger = document.getElementById('hamburger');
      const sidebarClose = document.getElementById('sidebarClose');
      const leftLogo = document.getElementById('leftLogo');
      const rightLogo = document.getElementById('rightLogo');
      const sbLeftLogo = document.getElementById('sbLeftLogo');

      function updateMobileUI() {
          const isMobile = window.innerWidth <= 720;
          const hb = document.getElementById('hamburger');
          if (hb) hb.style.display = isMobile ? 'inline-flex' : 'none';
          if (rightLogo) rightLogo.style.display = isMobile ? 'none' : '';
      }
      updateMobileUI();
      window.addEventListener('resize', updateMobileUI);

      function openSidebar() {
          sidebar.classList.add('open');
          overlay.classList.add('show');
          sidebar.setAttribute('aria-hidden', 'false');
          hamburger.setAttribute('aria-expanded', 'true');
          document.body.style.overflow = 'hidden';
      }

      function closeSidebar() {
          sidebar.classList.remove('open');
          overlay.classList.remove('show');
          sidebar.setAttribute('aria-hidden', 'true');
          hamburger.setAttribute('aria-expanded', 'false');
          document.body.style.overflow = '';
      }

      if (hamburger) hamburger.addEventListener('click', () => sidebar.classList.contains('open') ? closeSidebar() : openSidebar());
      if (sidebarClose) sidebarClose.addEventListener('click', closeSidebar);
      overlay.addEventListener('click', closeSidebar);

      document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && sidebar.classList.contains('open')) closeSidebar();
      });

      const io = new IntersectionObserver((entries, obs) => {
          entries.forEach(entry => {
              if (entry.isIntersecting) {
                  entry.target.classList.add('in-view');
                  obs.unobserve(entry.target);
              }
          });
      }, { threshold: 0.12 });

      document.querySelectorAll('.grid-item, .hero').forEach(el => io.observe(el));

      document.querySelectorAll('.grid-item').forEach(card => {
          const layer = card.querySelector('.ripple-layer');
          card.addEventListener('click', (ev) => {
              const rect = card.getBoundingClientRect();
              const size = Math.max(rect.width, rect.height) * 1.6;
              const ripple = document.createElement('span');

              ripple.style.position = 'absolute';
              ripple.style.borderRadius = '50%';
              ripple.style.pointerEvents = 'none';
              ripple.style.width = ripple.style.height = size + 'px';
              const x = ev.clientX - rect.left - size / 2;
              const y = ev.clientY - rect.top - size / 2;
              ripple.style.left = x + 'px';
              ripple.style.top = y + 'px';
              ripple.style.background = 'radial-gradient(circle at center, rgba(123,97,255,0.28), rgba(74,195,255,0.18) 40%, rgba(74,195,255,0.06) 60%, rgba(255,255,255,0.02) 100%)';
              ripple.style.transform = 'scale(0.2)';
              ripple.style.opacity = '0.95';
              ripple.style.transition = 'transform 600ms cubic-bezier(.2,.9,.2,1), opacity 420ms ease';
              layer.appendChild(ripple);
              requestAnimationFrame(() => {
                  ripple.style.transform = 'scale(1)';
                  ripple.style.opacity = '0';
              });
              setTimeout(() => ripple.remove(), 700);

              card.style.transform = 'translateY(-6px) scale(0.996)';
              setTimeout(() => { card.style.transform = ''; }, 220);
          });

          card.addEventListener('mouseenter', () => card.style.cursor = 'pointer');
      });

      function setLogos(left, right) {
          if (left) { leftLogo.src = left; if (sbLeftLogo) sbLeftLogo.src = left; }
          if (right) rightLogo.src = right;
      }
      window.setLogos = setLogos;

      // Hero section dynamic updates
      let lastHeroUpdate = null;

async function updateHeroSection() {
    const params = lastHeroUpdate ? `?last_update=${lastHeroUpdate}` : "";

    const res = await fetch(`/api/hero-section${params}`);
    const data = await res.json();

    if (data.status === "not_modified") return;

    if (data.updated_at) {
        lastHeroUpdate = data.updated_at;
    }

    if (data.hero_title)
        document.querySelector("#heroTitle").textContent = data.hero_title;

    if (data.btn1_label) {
        const btn1 = document.querySelector("#heroBtn1");
        btn1.textContent = data.btn1_label;
        btn1.href = data.btn1_link;
    }

    if (data.btn2_label) {
        const btn2 = document.querySelector("#heroBtn2");
        btn2.textContent = data.btn2_label;
        btn2.href = data.btn2_link;
    }

    if (data.hero_image_url)
        document.querySelector("#heroImage").src = data.hero_image_url;
}

setInterval(() => {
    const currentPage = history.state?.page;
    if (currentPage === "main") {
        updateHeroSection();
    }
}, 5000);


 
  let allEvents = [];

async function loadEventsPage() {
    const grid = document.getElementById("eventsGrid");
    if (!grid) return;

    const res = await fetch("/api/events");
    const data = await res.json();

    grid.innerHTML = "";
    allEvents = data.events || [];

    allEvents.forEach((ev, index) => {
        grid.innerHTML += `
            <div class="event-card">
                <div class="event-image">
                    <img src="${ev.image_url}">
                </div>
                <div class="event-info">
                    <h3>${ev.title}</h3>
                    <p class="date">${ev.date}</p>
                    <a href="#" class="btn btn-see-more" data-index="${index}">See More</a>
                </div>
            </div>
        `;
    });
}

// ===== CLEAN MODAL SYSTEM =====
let currentEventIndex = null;

function openEventModal(index) {
  const modal = document.getElementById("eventModal");
  const card  = document.getElementById("eventModalCard");
  const ev    = allEvents[index];
  if (!modal || !ev) return;

  // fill modal data
  document.getElementById("modalImage").src = ev.image_url || "";
  document.getElementById("modalTitle").innerText = ev.title || "";
  document.getElementById("modalDate").innerText = ev.date || "";
  const p = document.getElementById("modalParticipants");
  if (p) p.innerText = ev.participants ? `Participants: ${ev.participants}` : "";
  document.getElementById("modalDescription").innerText = ev.description || "";

  // open with animation
  modal.style.display = "flex";
  document.body.style.overflow = "hidden";

  requestAnimationFrame(() => {
    modal.classList.add("show");
  });
}

function closeEventModal() {
  const modal = document.getElementById("eventModal");
  if (!modal) return;

  modal.classList.remove("show");
  document.body.style.overflow = "";

  setTimeout(() => {
    modal.style.display = "none";
  }, 300);
}

// Global click handler (works with dynamic HTML)
document.addEventListener("click", (e) => {
  // open
  if (e.target.classList.contains("btn-see-more")) {
    e.preventDefault();
    const index = e.target.dataset.index;
    openEventModal(index);
  }

  // close by button
  if (e.target.id === "closeEventModal") {
    closeEventModal();
  }

  // close by outside click
  if (e.target.classList.contains("event-modal")) {
    closeEventModal();
  }
});

// ESC key close
document.addEventListener("keydown", (e) => {
  if (e.key === "Escape") {
    closeEventModal();
  }
});


 });
  </script>
  </body>

  </html>